<!-- <template>
  <div class="container" style="max-width: 500px">
    <div class="video-container">
      <canvas ref="canvas"></canvas>
      <video ref="video" autoplay muted></video>
      <div class="face-id-step" :class="faceIDStore.renderStyle()">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="axis" ref="axis">
          <div class="a-x">
            <div></div>
          </div>
          <div class="a-y">
            <div></div>
          </div>
        </div>
      </div>
      <div class="face-background"></div>
      <div class="face-id-loading" v-show="faceIDStore.isLoading">
        <div class="bg-loading">
          <div></div>
          <div></div>
          <div></div>
        </div>
      </div>
    </div>
    <div class="face-id-text" v-show="faceIDStore.textStep != null">
      {{ faceIDStore.textStep }}
    </div>
  </div>
</template>

<script setup>
import useFaceIDStore from '@/stores/useFaceIDStore'
import { nextTick, onMounted, ref } from 'vue'
const faceIDStore = useFaceIDStore()
const video = ref(null)
const canvas = ref(null)
const axis = ref(null)

onMounted(async () => {
  await faceIDStore.loadModels()

  faceIDStore.init(video, canvas, axis, false, (descriptor) => {
    const data = [
      -0.041032128036022186, 0.10955234616994858, 0.018543614074587822, -0.03571907803416252,
      -0.07458042353391647, -0.08866432309150696, 0.00974403228610754, -0.08018680661916733,
      0.19189108908176422, -0.0147093515843153, 0.2934196889400482, -0.10293560475111008,
      -0.1694958508014679, -0.10956747829914093, 0.006702260579913855, 0.1809459924697876,
      -0.21092087030410767, -0.05583532899618149, -0.11633593589067459, 0.008341385051608086,
      0.10912160575389862, -0.032529737800359726, 0.03134191036224365, 0.0986742302775383,
      -0.08220218122005463, -0.37672773003578186, -0.048871271312236786, -0.10695236921310425,
      0.054279226809740067, -0.11990750581026077, -0.05919656902551651, 0.08931638300418854,
      -0.13316945731639862, -0.1427079141139984, 0.028712198138237, 0.06640952825546265,
      -0.06593622267246246, -0.006209071725606918, 0.18697308003902435, 0.011432395316660404,
      -0.23184235394001007, 0.09648547321557999, 0.019961146637797356, 0.32734984159469604,
      0.21829792857170105, 0.09894990921020508, 0.02568182162940502, -0.08088378608226776,
      0.1407797783613205, -0.22146862745285034, 0.048543158918619156, 0.1263478696346283,
      0.13883109390735626, 0.01872292347252369, 0.049295105040073395, -0.09766566008329391,
      0.004047229420393705, 0.10908016562461853, -0.2646200954914093, 0.04079878702759743,
      0.13135524094104767, -0.10525903105735779, -0.03929753229022026, -0.07306824624538422,
      0.17904630303382874, 0.09571442008018494, -0.10906805843114853, -0.08489791303873062,
      0.09659809619188309, -0.11286979913711548, -0.05017634481191635, 0.028134552761912346,
      -0.15180785953998566, -0.20966489613056183, -0.3082990348339081, 0.01379365660250187,
      0.45737379789352417, 0.08378143608570099, -0.202401801943779, -0.006176547612994909,
      -0.03184003010392189, -0.015734268352389336, 0.11912699043750763, 0.09980102628469467,
      -0.03612488880753517, -0.013344835489988327, -0.11752385646104813, 0.048691220581531525,
      0.11795783787965775, -0.08917606621980667, 0.007239753846079111, 0.22196392714977264,
      0.012735391966998577, 0.027943260967731476, -0.020644959062337875, 4.445152007974684e-4,
      -0.09174849092960358, 0.06977280974388123, -0.16122816503047943, -0.022135380655527115,
      0.015217396430671215, -0.025589972734451294, 0.0195436030626297, 0.03041396476328373,
      -0.18247833847999573, 0.15111449360847473, 0.048210132867097855, 0.0226744394749403,
      0.003304291283711791, -0.012960792519152164, -0.08247091621160507, -0.05775649845600128,
      0.12612317502498627, -0.21595355868339539, 0.162618026137352, 0.20162604749202728,
      0.0928485244512558, 0.10629439353942871, 0.031238848343491554, 0.017877981066703796,
      0.02402358129620552, -0.016958624124526978, -0.19472479820251465, 0.013445412740111351,
      0.0906655564904213, -0.002069368725642562, 0.07094427943229675, -0.0018122498877346516,
    ]

    const data1 = [
      -0.06782650202512741, 0.0971759557723999, 0.08407099545001984, -0.014452032744884491,
      -0.09420572221279144, -0.06471080332994461, -0.02808828465640545, -0.09900219738483429,
      0.1177273616194725, -0.06709486991167068, 0.3077969551086426, -0.07373683899641037,
      -0.16322532296180725, -0.11149267107248306, -0.06870589405298233, 0.1744597852230072,
      -0.10339433699846268, -0.1582435816526413, -0.04098597541451454, -0.017836429178714752,
      0.008997722528874874, -0.04867084324359894, 0.0007602637051604688, 0.10197285562753677,
      -0.05063086003065109, -0.31152868270874023, -0.06900191307067871, -0.08975916355848312,
      0.05390169471502304, -0.07716653496026993, -0.09073913097381592, 0.07256333529949188,
      -0.17573080956935883, -0.08733537793159485, 0.029101863503456116, 0.03344034031033516,
      -0.009211394935846329, -0.009099654853343964, 0.1819377988576889, 0.027787601575255394,
      -0.20905576646327972, 0.03216813504695892, 0.045964207500219345, 0.311664879322052,
      0.13652947545051575, 0.08757524937391281, 0.019258638843894005, -0.0994800329208374,
      0.07690710574388504, -0.14605072140693665, 0.08637991547584534, 0.1274738758802414,
      0.1434878557920456, 0.04669398069381714, -0.014423856511712074, -0.1624780297279358,
      -0.008342131040990353, 0.13649167120456696, -0.12253455817699432, 0.06442618370056152,
      0.023564955219626427, -0.05109471455216408, -0.003459230065345764, -0.10989954322576523,
      0.33033129572868347, 0.060064882040023804, -0.12219971418380737, -0.09697607904672623,
      0.13526859879493713, -0.06931661069393158, -0.06915910542011261, 0.07561203092336655,
      -0.1435859352350235, -0.13159123063087463, -0.279382586479187, 0.09234882146120071,
      0.4322940707206726, 0.09449903666973114, -0.18682964146137238, 0.03511317819356918,
      -0.11564723402261734, -0.03453536704182625, 0.014573129825294018, 0.1082579493522644,
      -0.10481294244527817, 0.048628613352775574, -0.07485406845808029, -0.05105915665626526,
      0.19536158442497253, -0.015552129596471786, -0.006154050584882498, 0.21722063422203064,
      -0.039569735527038574, 0.0588841438293457, -0.00923781655728817, -0.041062161326408386,
      -0.07313483208417892, 0.021115461364388466, -0.1311258226633072, -0.10348008573055267,
      -0.016772711649537086, -0.06686857342720032, 0.009750455617904663, 0.09278357774019241,
      -0.2669118642807007, 0.06112752854824066, 0.02865009382367134, 0.03388408571481705,
      0.03680494427680969, 0.08809281140565872, -0.06729099154472351, -0.10591738671064377,
      0.12036681920289993, -0.25203368067741394, 0.19112767279148102, 0.16873565316200256,
      0.20726339519023895, 0.10804811120033264, 0.14536765217781067, 0.029924940317869186,
      0.015567472204566002, -0.06312598288059235, -0.11537398397922516, 0.028822163119912148,
      0.16198748350143433, -0.07788849622011185, 0.09880034625530243, 0.052271947264671326,
    ]
    console.log(descriptor)
    descriptor.forEach((o) => {
      const distance = euclideanDistance(o, data)
      if (distance < 0.5) {
        console.log('Giống nhau')
      } else {
        console.log('Khác nhau')
      }
    })
  })
  await nextTick()
  await faceIDStore.startVideo()
})

function euclideanDistance(desc1, desc2) {
  let sum = 0
  for (let i = 0; i < desc1.length; i++) {
    const diff = desc1[i] - desc2[i]
    sum += diff * diff
  }
  return Math.sqrt(sum)
}
</script> -->
